Quiero que actualices la estructura de la base de datos de mi aplicación de registro de jornada laboral. 
Actualmente ya existe una base de datos con otra estructura, pero deseo modificarla para aplicar el nuevo diseño. 
Debes hacer los cambios en la base de datos y después actualizar el código de la aplicación para que todo siga funcionando correctamente.

### Requisitos de la nueva estructura:

1. Tabla `empleado` (si no existe, créala):
   - id_empleado (PK, BIGINT)
   - id_empresa (BIGINT, NOT NULL)
   - nombre (VARCHAR)
   - apellido (VARCHAR)
   - email (VARCHAR, UNIQUE)
   - departamento (VARCHAR)
   - puesto (VARCHAR)
   - fecha_alta (DATE)
   - fecha_baja (DATE, NULL)
   - activo (BOOLEAN, DEFAULT TRUE)

2. Tabla `horario_planificado` (antes llamada turno):
   - id_turno (PK, BIGINT)
   - id_empleado (FK -> empleado.id_empleado)
   - fecha (DATE, NOT NULL)
   - hora_inicio_prevista (TIME)
   - hora_fin_prevista (TIME)
   - tipo_turno (VARCHAR) -- mañana, tarde, noche
   - estado (VARCHAR, DEFAULT 'pendiente')

3. Tabla `fichaje` (antes llamada registro_jornada):
   - id_registro (PK, BIGINT)
   - id_empleado (FK -> empleado.id_empleado)
   - id_turno (FK -> horario_planificado.id_turno, NULL)
   - tipo_registro (VARCHAR, NOT NULL) -- 'entrada', 'salida', 'pausa_inicio', 'pausa_fin'
   - timestamp_registro (TIMESTAMP, DEFAULT NOW())
   - origen (VARCHAR) -- app móvil, terminal físico, web
   - observaciones (TEXT)

4. Nueva tabla `jornada_diaria`:
   - id_jornada (PK, BIGINT, autoincrement)
   - id_empleado (FK -> empleado.id_empleado)
   - fecha (DATE, NOT NULL)
   - hora_inicio (TIMESTAMP, NULL)
   - hora_fin (TIMESTAMP, NULL)
   - horas_trabajadas (NUMERIC(6,2), DEFAULT 0)
   - horas_pausas (NUMERIC(6,2), DEFAULT 0)
   - horas_extra (NUMERIC(6,2), DEFAULT 0)
   - estado (VARCHAR, DEFAULT 'abierta')

### Triggers:
Debes crear un TRIGGER en la tabla `fichaje` que:
- Se ejecute `AFTER INSERT`.
- Detecte el empleado y la fecha del nuevo registro.
- Inserte o actualice la fila correspondiente en `jornada_diaria` recalculando:
  - `hora_inicio` = primer fichaje de tipo 'entrada' del día.
  - `hora_fin` = último fichaje de tipo 'salida' del día.
  - `horas_trabajadas` = diferencia entre entrada y salida menos pausas.
  - `horas_pausas` = duración total de pausas (pausa_fin - pausa_inicio).
- Si la fila ya existe en `jornada_diaria`, debe hacer un `UPDATE` en lugar de `INSERT`.

### Consideraciones:
- Aplica la migración sobre la base de datos existente (adaptando tablas actuales a la nueva estructura).
- Actualiza el código de la aplicación para que ahora use las tablas `horario_planificado`, `fichaje` y `jornada_diaria`.
- Verifica que los informes oficiales de jornada laboral usen la tabla `jornada_diaria` para el inspector de trabajo.
